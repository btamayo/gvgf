node {
	stage('Print ENV') {
        echo sh(returnStdout: true, script: 'env')
	}
    stage('Pull repository') {
        checkout([$class: 'GitSCM', branches: [[name: '**']], doGenerateSubmoduleConfigurations: false, extensions: [], submoduleCfg: [], userRemoteConfigs: [[credentialsId: '134d1586-2a3b-4dee-8118-7376c7b4a069', url: 'https://github.com/btamayo/gvgf']]])
    }
    stage('Build Test Docker Image') {
    	// The last param always has to be the context
    	def test_image = docker.build('python_test', ' -f Dockerfile .')
    	test_image.inside {
    		sh('pytest')
            // @TODO: Pytest exit code 5 means no tests were found
    	}
    }
}
